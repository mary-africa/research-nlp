# Experimental Text Tools Based on SED Morphology Analysis

## Project Structure

```
mary-experiments
├─ README.md
├─ language-model.ipynb
├─ requirements.txt
├─ text
│  ├─ __init__.py
│  ├─ data
│  │  ├─ __init__.py
│  │  ├─ datasets.py
│  │  ├─ postprocessing.py
│  │  ├─ preprocessing.py
│  │  ├─ structures.py
│  │  └─ vocab.py
│  ├─ networks
│  │  ├─ __init__.py
│  │  ├─ attention.py
│  │  ├─ embeddings.py
│  │  └─ highway.py
│  └─ utils
│     ├─ __init__.py
│     ├─ config.py
│     ├─ heuristic.py
│     ├─ models.py
│     ├─ morphology.py
│     └─ pipeline.py

```

# DATA
This directory contains modules that handle the reading, processing, and loading of the text data. 

### Datasets 
This module is used when training the pytorch Neural Network. It uses the Vocab module to read and preprocess the data which is then passed on to the data loader in the pipeline for batch processing in the model.

### Postprocessing 
This module deals with processing of batch data once it has been passed through the model and before backpropagation of the loss is done. It consists of the Attract-Repel mechanism used to define a custom loss for the Language model.

### Preprocessing 
This module contains classes used in preparing the data to be fed into the models. It contains label and one-hot encoders for converting text into their numeric representations as well as a Morpheme Encoder that breaks text using the SED Heuristic to obtain the morphemes(tokens).

### Structures
The classes and functions in this module are used in loading and tokenizing/breaking the text data. The classes included read text data from file and create instances which can be made to return individual lines/sentences from the text document with their corresponding morpheme encoded text.

### Vocab
This contains the vocab.py class which is used in the pytorch networks such as the embedings and models. It utilizes the Document class from the Structures module to load the text data and can be used to load the label encoded text and morphemes which are then passed into the models.


# Networks 
This directory contains modules for Neural Network components used in building the various models for text analysis.

### Attention
A pytorch implementation of the "attention is all you need" paper, adapted from a Harvard open source project. Used as a composition function for creating word embeddings from their constituting morpheme vectors

### Embeddings 
Contains several classes used in constructing morpheme-level embeddings and composing them into word embeddings to be used in downstream tasks such as sentiment analysis and language modeling

### Highway
Highway network used in conjuction with the CNN composition function to create word embeddings from constituing morpheme vectors.

# Utils
These are tools used in setting up and executing the entire modeling/analysis pipeline. 

### Config
Contains configurations used in achieving current results including model parameters.

### Heuristic
SED heuristic upon which the entire workflow is based. This class contains the algorithm used to detect morpheme boundaries in morphologically rich languages and create a template to be used downstream for breaking text based on said boundaries.

### Models
This is where the various text modeling classes for downstream tasks such as language modeling and sentiment analysis are defined. 

### Morphology
This module defines the rules for using templates generated by the SED heuristic to break down swahili text into morphemes to be used as tokens. 

### Pipeline 
Contains classes describing the model training and inference phases.

# Language Modeling 
Follow instructions in the language-model.ipynb notebook. Remember to either download the data files into your root folder after cloning the repo or change the file path in the config file to where you saved them.